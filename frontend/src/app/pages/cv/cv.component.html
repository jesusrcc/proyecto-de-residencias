<div class="cv-container" *ngIf="user" #cvContent>
  <div class="cv-header">
    <div class="photo-box">
  <img *ngIf="user.photoUrl" [src]="user.photoUrl" alt="Foto de perfil" />
  <div *ngIf="!user.photoUrl" class="photo-placeholder">ðŸ“¸</div>
</div>


    <div class="info">
      <h2>{{ user.name }} {{ user.firstName }} {{ user.lastName }}</h2>
      <p class="institution">
        <strong>Departamento / InstituciÃ³n</strong> â€” 
        {{ user.country || ' ' }}
      </p>
      <p>ORCID: {{ user.orcid || 'â€”' }}</p>
      <p>{{ user.email }}</p>
    </div>
  </div>

  <div class="cv-section">
    <h3>Trayectoria acadÃ©mica</h3>

    <h4>ProducciÃ³n acadÃ©mica</h4>
    <ol>
      <li *ngFor="let pub of user.publications">
        <strong>{{ pub.title }}</strong>
        <span *ngIf="pub.journal">, {{ pub.journal }}</span>
        <span *ngIf="pub.date"> â€” {{ formatDate(pub.date) }}</span>
      </li>
    </ol>

    <h4>Cursos y formaciÃ³n</h4>
    <ul>
      <li *ngFor="let c of user.courses">
        <strong>{{ c.title }}</strong>
        <span *ngIf="c.institution"> â€” {{ c.institution }}</span>
        <span *ngIf="c.date"> ({{ formatDate(c.date) }})</span>
      </li>
    </ul>

    <h4>Hitos</h4>
    <ul>
      <li *ngFor="let h of user.milestones">
        <span *ngIf="h.date">{{ formatDate(h.date) }} â€” </span>
        <strong>{{ h.title }}</strong>
        <span *ngIf="h.type"> ({{ h.type }})</span>
        <p *ngIf="h.description" class="milestone-description">
          {{ h.description }}
        </p>
      </li>
    </ul>
  </div>

  <div class="cv-footer">
    <button class="export-btn" (click)="exportPDF()">Exportar a PDF</button>
    <button class="share-btn" (click)="shareCV()" title = "Compartir">
      <i class="fa-regular fa-share-from-square"></i>
    </button>
  </div>
</div>

<div *ngIf="!user" class="no-data">
  <p>No hay datos disponibles. Completa primero tu formulario de investigador.</p>
</div>
